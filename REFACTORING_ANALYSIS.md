# üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞: SOLID, DRY, KISS

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞**: 2025-10-25
**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞**: 7.5/10

## ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø—Ä–æ–µ–∫—Ç–∞

### 1. SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã - —Ö–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã

#### ‚úÖ Single Responsibility Principle (SRP)
- `calculations.ts` - —Ç–æ–ª—å–∫–æ —Ä–∞—Å—á–µ—Ç—ã
- `sessionService.ts` - —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- `validation.ts` - —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- `telegram.ts` - —Ç–æ–ª—å–∫–æ Telegram API

#### ‚úÖ Open/Closed Principle (OCP)
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ISessionService` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- Zod —Å—Ö–µ–º—ã –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è

#### ‚úÖ Dependency Inversion Principle (DIP)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (`ISessionService`)
- –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –ë–î (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ Neon –∏ local pg)

### 2. DRY - —Ö–æ—Ä–æ—à–æ –ø—Ä–∏–º–µ–Ω–µ–Ω

‚úÖ –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `src/constants/fields.ts`
‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ö—É–∫–∏: `useSessionData`, `useSelectOnFocus`
‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–æ–≤: `recalculateRow()`

### 3. KISS - –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –ø–æ–Ω—è—Ç–Ω–æ—Å—Ç—å

‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π
‚úÖ –ü—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω—ã–π data flow
‚úÖ –ü–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

---

## ‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### –ü–†–û–ë–õ–ï–ú–ê 1: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫
**–§–∞–π–ª**: `src/components/SimpleEditableTable.tsx:266-277`
**–ü—Ä–∏–Ω—Ü–∏–ø**: DRY

–î—É–±–ª–∏—Ä—É–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `data` –∏ `originalData`:
```typescript
setData(prevData => ...)
setOriginalData(prevData => ...) // —Ç–∞ –∂–µ –ª–æ–≥–∏–∫–∞
```

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `updateBothDataStates`

#### –ü–†–û–ë–õ–ï–ú–ê 2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Å—á–µ—Ç–∞ ID —Å—Ç—Ä–æ–∫
**–§–∞–π–ª**: `src/components/SimpleEditableTable.tsx` (6 –º–µ—Å—Ç)
**–ü—Ä–∏–Ω—Ü–∏–ø**: DRY

–õ–æ–≥–∏–∫–∞ `.map((row, index) => ({ ...row, '#': index + 1 }))` –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è 6 —Ä–∞–∑

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É `recalculateRowNumbers()`

#### –ü–†–û–ë–õ–ï–ú–ê 3: –°–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç SimpleEditableTable
**–§–∞–π–ª**: `src/components/SimpleEditableTable.tsx` (572 —Å—Ç—Ä–æ–∫–∏)
**–ü—Ä–∏–Ω—Ü–∏–ø**: KISS, SRP

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ:
- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–∞–±–ª–∏—Ü—ã
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (6 —Å–æ—Å—Ç–æ—è–Ω–∏–π)
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Å—Ç—Ä–æ–∫–∞–º–∏ (add, delete, move, copy)
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —è—á–µ–µ–∫

**–†–µ—à–µ–Ω–∏–µ**: –†–∞–∑–±–∏—Ç—å –Ω–∞:
- `useTableRowOperations` hook
- `useTableSort` hook
- `TableAccordionRow` component
- `TableControls` component

---

### üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### –ü–†–û–ë–õ–ï–ú–ê 4: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ rate limiting –≤ API
**–§–∞–π–ª**: `src/app/api/session/route.ts:14-37, 94-117`
**–ü—Ä–∏–Ω—Ü–∏–ø**: DRY

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å HOF `withRateLimit`

#### –ü–†–û–ë–õ–ï–ú–ê 5: Demo data –≤ —Ö—É–∫–µ
**–§–∞–π–ª**: `src/hooks/useSessionData.ts:7-129`
**–ü—Ä–∏–Ω—Ü–∏–ø**: SRP

122 —Å—Ç—Ä–æ–∫–∏ demo –¥–∞–Ω–Ω—ã—Ö –≤ —Ö—É–∫–µ

**–†–µ—à–µ–Ω–∏–µ**: –í—ã–Ω–µ—Å—Ç–∏ –≤ `src/test-data/demoReceiptData.ts`

#### –ü–†–û–ë–õ–ï–ú–ê 6: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ UUID –≤–∞–ª–∏–¥–∞—Ü–∏–∏
**–§–∞–π–ª—ã**: `src/lib/telegram.ts:25-28`, `src/lib/validation.ts`
**–ü—Ä–∏–Ω—Ü–∏–ø**: DRY

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ `validation.ts`

#### –ü–†–û–ë–õ–ï–ú–ê 7: –°–ª–æ–∂–Ω—ã–π useEffect –≤ PWAProvider
**–§–∞–π–ª**: `src/components/PWAProvider.tsx:41-131`
**–ü—Ä–∏–Ω—Ü–∏–ø**: KISS, SRP

–û–¥–∏–Ω useEffect –¥–µ–ª–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ

**–†–µ—à–µ–Ω–∏–µ**: –†–∞–∑–±–∏—Ç—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ useEffect

---

### üü¢ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### –ü–†–û–ë–õ–ï–ú–ê 8: –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞
**–§–∞–π–ª—ã**: –†–∞–∑–ª–∏—á–Ω—ã–µ
**–ü—Ä–∏–Ω—Ü–∏–ø**: KISS

–•–∞—Ä–¥–∫–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π: `'1.3em'`, `'20px'`, `4096`, `100`

**–†–µ—à–µ–Ω–∏–µ**: –í—ã–Ω–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

#### –ü–†–û–ë–õ–ï–ú–ê 9: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ inline —Å—Ç–∏–ª–µ–π
**–§–∞–π–ª**: `src/components/SimpleEditableTable.tsx:307-367`
**–ü—Ä–∏–Ω—Ü–∏–ø**: DRY

**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å CSS –∫–ª–∞—Å—Å—ã –∏–ª–∏ styled –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

---

## üìã –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–±–ª–µ–º

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–Ω—Ü–∏–ø | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ |
|---|----------|---------|-----------|------|--------|
| 1 | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ | DRY | üî¥ –í—ã—Å–æ–∫–∏–π | SimpleEditableTable.tsx | 266-277 |
| 2 | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Å—á–µ—Ç–∞ ID —Å—Ç—Ä–æ–∫ | DRY | üî¥ –í—ã—Å–æ–∫–∏–π | SimpleEditableTable.tsx | –ú–Ω–æ–∂–µ—Å—Ç–≤–æ |
| 3 | –°–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | KISS, SRP | üî¥ –í—ã—Å–æ–∫–∏–π | SimpleEditableTable.tsx | –í–µ—Å—å —Ñ–∞–π–ª |
| 4 | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ rate limiting | DRY | üü° –°—Ä–µ–¥–Ω–∏–π | route.ts | 14-37, 94-117 |
| 5 | Demo data –≤ —Ö—É–∫–µ | SRP | üü° –°—Ä–µ–¥–Ω–∏–π | useSessionData.ts | 7-129 |
| 6 | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ UUID –≤–∞–ª–∏–¥–∞—Ü–∏–∏ | DRY | üü° –°—Ä–µ–¥–Ω–∏–π | telegram.ts, validation.ts | 25-28 |
| 7 | –°–ª–æ–∂–Ω—ã–π useEffect | KISS, SRP | üü° –°—Ä–µ–¥–Ω–∏–π | PWAProvider.tsx | 41-131 |
| 8 | –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ | KISS | üü¢ –ù–∏–∑–∫–∏–π | –†–∞–∑–ª–∏—á–Ω—ã–µ | –†–∞–∑–ª–∏—á–Ω—ã–µ |
| 9 | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ inline —Å—Ç–∏–ª–µ–π | DRY | üü¢ –ù–∏–∑–∫–∏–π | SimpleEditableTable.tsx | 307-367 |

---

## üéØ –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –≠—Ç–∞–ø 1: –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É `recalculateRowNumbers()` –≤ `src/lib/tableUtils.ts`
2. ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `SimpleEditableTable.tsx`:
   - –°–æ–∑–¥–∞—Ç—å `useTableRowOperations` hook
   - –°–æ–∑–¥–∞—Ç—å `useTableSort` hook
   - –°–æ–∑–¥–∞—Ç—å `TableControls` component
   - –£–ø—Ä–æ—Å—Ç–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

### –≠—Ç–∞–ø 2: –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
3. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ demo data –≤ `src/test-data/demoReceiptData.ts`
4. ‚úÖ –°–æ–∑–¥–∞—Ç—å HOF `withRateLimit` –≤ `src/lib/apiHelpers.ts`
5. ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å UUID –≤–∞–ª–∏–¥–∞—Ü–∏—é
6. ‚úÖ –£–ø—Ä–æ—Å—Ç–∏—Ç—å PWAProvider

### –≠—Ç–∞–ø 3: –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
7. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
8. ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∏–ª–µ–π

---

## ‚ú® –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ `SimpleEditableTable.tsx` —Å 572 –¥–æ ~200 —Å—Ç—Ä–æ–∫
- –£–ª—É—á—à–µ–Ω–∏–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç–∏ –∫–æ–¥–∞
- –£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –£–ª—É—á—à–µ–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∫–æ–¥–∞
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SOLID, DRY, KISS –ø—Ä–∏–Ω—Ü–∏–ø–∞–º

**–¶–µ–ª–µ–≤–∞—è –æ—Ü–µ–Ω–∫–∞**: 9/10
